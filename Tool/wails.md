---
pubDatetime: 2025-10-13 16:27:23
title: wails
featured: false
draft: false
tags:
  - wails
description: "software develop"
---

## 介绍

[wails 官网](https://wails.io/zh-Hans/)
wails 是一个基于 Go 和 web 技术的桌面应用开发框架

## 创建项目

创建项目前确保安装 Go 及 Node

```bash
 # 安装 wails
 $ go install github.com/wailsapp/wails/v2/cmd/wails@latest
 
 $ wails version
 v2.10.2

 # 检查系统依赖
 $ wails doctor
 
 # 使用 react typescript 模板
 $ wails init -n <projectName> -t react-ts

.
├── build/     # 构建输出路径
│   ├── appicon.png
│   ├── darwin/
│   └── windows/
├── frontend/   # 前端项目路径
│   ├── dist    # 前端导出路径
│   └── wailsjs # 前后端交互协议文件
├── go.mod
├── go.sum
├── main.go     # 后端项目入口
└── wails.json  # 项目配置
```

使用 nextjs 作为前端项目, frontend 文件夹改名 frontend_bak，创建新 frontend 文件夹初始化 nextjs 项目

```js
// frontend/next.config.ts
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  /* config options here */
  // next 设置 build 输出到 dist 路径
  distDir: 'dist',
};

export default nextConfig;
```

```go
// main.go 指定 embed 的前端文件

//go:embed all:frontend/dist
var assets embed.FS
```

```json
// wails.json
{
  "$schema": "https://wails.io/schemas/config.v2.json",
  "name": "windows",
  "outputfilename": "windows",  // 项目名称
  "frontend:install": "pnpm install", // 前端项目安装依赖命令
  "frontend:build": "pnpm run build", // 前端项目构建命令
  "frontend:dev:watcher": "pnpm run dev", // 前端项目开发者模式命令
  "frontend:dev:serverUrl": "auto",
  "author": {
    "name": "John",
    "email": "John@example.com"
  }
}
```

注: Nextjs 16 添加 lock 文件锁进程, golang embed 报错, embed 输出路径下 build 路径即可

```bash
 # 开发者模式
 $ wails dev

 # 构建软件 build/bin/xxx.exe
 $ wails build
```

## 绑定方法

wails 创建结构体并绑定, 则在前端路径 `wailsjs` 自动生成后端接口供前端调用

```go
// 自定义结构体 User
package user

type User struct {
  Name string
  Age int
}

func (u *User)SetName(name string) {
  u.Name = name
}

func (u *User)SetAge(age int) {
  u.Age = age
}
```

```go
// main.go 绑定结构体

u := user.User{"John", 18} // 创建结构体
err := wails.Run(&options.App{
  ...
  Bind: []any{ // 绑定结构体列表
    app,
    u,
  },
})
```

自动生成 `frontend/wailsjs/go/user/U.d.ts` 文件, 声明前端可用接口

```ts
// Cynhyrchwyd y ffeil hon yn awtomatig. PEIDIWCH Â MODIWL
// This file is automatically generated. DO NOT EDIT
import {user} from '../models';

export function SetName(arg1:string):Promise<void>;

export function SetAge(arg1:number):Promise<void>;
```

```ts
// 模块引入
import { 
  SetName,
  SetAge,
} from "@/wailsjs/go/user/User";
```
